import{_ as w,c as b,r as T,o as n,e as o,f as t,g as V,i as g,F as d,q as u,h as y,t as f}from"./index-gxZJ1D_R.js";import{a as S}from"./teacherClassApi-G0G2uyYe.js";const A={class:"container my-5 p-5 bg-light rounded"},I={key:0,class:"mt-4"},B=["onClick"],N={class:"text-center mt-3"},j=["disabled"],L={key:1,class:"mt-5"},q={class:"table table-striped"},z={__name:"TeacherClass",setup(E){const m=b(null),a=T([]),i=b([]),h=s=>{const e=s.target.files;v(e);for(let l=0;l<e.length;l++){const r=e[l];if(r&&r.type==="text/csv"){const c=new FileReader;c.onload=p=>{const D=p.target.result;i.value=_(D),console.log("CSV Data Array:",i.value)},c.readAsText(r)}else console.error("Invalid file type. Please upload a CSV file.")}},_=s=>s.split(`
`).map(l=>l.split(",")),k=()=>{m.value.click()},v=s=>{for(let e=0;e<s.length;e++)a.push(s[e])},x=s=>{const e=s.dataTransfer.files;v(e)},C=s=>{a.splice(s,1)},F=async()=>{if(!a.length)return;const s=new FormData;s.append("file",a[0]);try{const e=await S.uploadCsv(s);console.log("파일 업로드 성공:",e),alert("파일이 성공적으로 등록되었습니다."),a.length=0}catch(e){console.error("파일 업로드 실패:",e),alert("파일 업로드 중 오류가 발생했습니다.")}};return(s,e)=>(n(),o("div",A,[e[4]||(e[4]=t("h3",{class:"mb-4"},[t("strong",null,"파일 업로드")],-1)),t("div",{class:"upload-box bg-light d-flex flex-column justify-content-center align-items-center p-5 rounded",onDragover:e[0]||(e[0]=g(()=>{},["prevent"])),onDrop:g(x,["prevent"])},[e[2]||(e[2]=t("p",{class:"text-center",style:{"font-size":"1.1rem"}},"파일을 여기에 끌어다 놓거나, 파일 선택 버튼을 눌러 파일을 직접 선택해주세요.",-1)),t("input",{type:"file",onChange:h,class:"d-none",ref_key:"fileInput",ref:m,accept:".xls,.xlsx,.csv"},null,544),t("button",{class:"btn btn-primary mt-3",onClick:k},e[1]||(e[1]=[t("i",{class:"bi bi-upload me-2"},null,-1),V("파일 선택 ")]))],32),a.length?(n(),o("div",I,[(n(!0),o(d,null,u(a,(l,r)=>(n(),o("div",{key:r,class:"d-flex justify-content-between align-items-center py-3 px-3 border"},[t("span",null,f(l.name),1),t("button",{class:"btn btn-link text-black",onClick:c=>C(r)},"X 삭제",8,B)]))),128))])):y("",!0),t("div",N,[t("button",{class:"btn btn-primary",disabled:!a.length,onClick:F}," 등록 ",8,j)]),i.value.length?(n(),o("div",L,[e[3]||(e[3]=t("h5",null,[t("strong",null,"CSV 파일 파싱 결과")],-1)),t("table",q,[t("thead",null,[t("tr",null,[(n(!0),o(d,null,u(i.value[0],(l,r)=>(n(),o("th",{key:r},f(l),1))),128))])]),t("tbody",null,[(n(!0),o(d,null,u(i.value.slice(1),(l,r)=>(n(),o("tr",{key:r},[(n(!0),o(d,null,u(l,(c,p)=>(n(),o("td",{key:p},f(c),1))),128))]))),128))])])])):y("",!0)]))}},R=w(z,[["__scopeId","data-v-03e15d52"]]);export{R as default};
