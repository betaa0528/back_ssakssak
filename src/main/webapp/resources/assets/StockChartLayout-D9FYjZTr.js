import{u as S}from"./stockStore-sz4ZB7M7.js";import{_ as w,d as r,c as f,p as V,o as k,e as $,k as q,z as B,B as j,b as N,f as t,t as p,w as Q,v as M,N as P,h as I,F as E,g as D}from"./index-gxZJ1D_R.js";import{a as T}from"./studentStockApi-CKw2OddO.js";const L={class:"container",style:{height:"100%"}},F={__name:"StockChart",setup(x){const b=S(),i=r(()=>b.chartData),e=r(()=>i.value.length===0?0:i.value.reduce((n,o)=>n.stockPrice>=o.stockPrice?n:o).stockPrice),m=n=>{if(!n||isNaN(n))return[0,0,0,0];const o=parseInt(n+(Math.random()*10-4)),s=parseInt(n+(Math.random()*8+2)),_=parseInt(n-(Math.random()*6+2)),h=parseInt(n),g=Math.max(o,s,h),y=Math.min(o,_,h);return[o,g,y,h]},d=n=>n.map(o=>({x:new Date(o.stockDate),y:m(o.stockPrice)})),c=f([{name:"Stock Prices",data:d(i.value)}]);V(i,n=>{c.value[0].data=d(n)});const u=f({chart:{id:"basic-bar"},plotOptions:{candlestick:{colors:{upward:"#3C90EB",downward:"#DF7D46"}}},height:"100%",xaxis:{type:"datetime",labels:{formatter:function(n){return new Date(n).getDate()}},tickAmount:i.value.length},yaxis:{tooltip:{enabled:!0},range:e.value+10}});return(n,o)=>(k(),$("div",L,[q(B(j),{style:{width:"100%",height:"100%"},type:"candlestick",options:u.value,series:c.value},null,8,["options","series"])]))}},O=w(F,[["__scopeId","data-v-c3a33878"]]),R={class:"modal-wrap"},U={class:"modal-container p-4 shadow-lg rounded bg-white"},A={class:"modal-body"},z={class:"mb-2"},H={class:"fs-5 fw-bold"},G={class:"mb-3"},J={class:"fs-5 fw-bold text-primary"},K={class:"mb-3"},W={class:"d-flex align-items-center"},X={class:"mt-2"},Y={class:"mb-3"},Z={class:"fw-bold"},tt={__name:"StockBuy",emits:["closePop"],setup(x,{emit:b}){const i=N(),e=f(""),m=S(),d=r(()=>m.myStock),c=r(()=>m.chartData),u=r(()=>{const a=c.value[c.value.length-1];return!a||!a.stockPrice?0:parseInt(d.value.seed/a.stockPrice)}),n=r(()=>c.value.length===0?0:c.value[c.value.length-1]);console.log(n.value.stockPrice);const o=r(()=>e.value*n.value.stockPrice),s=f({username:i.username,name:i.name,quantity:"",stock_price:""}),_=a=>{e.value=Number(e.value)+Number(a)},h=()=>{e.value=u.value},g=b,y=async()=>{s.value.quantity=e.value,s.value.stock_price=n.value.stockPrice;try{const a=await T.buyStock(s.value);m.updateMyStock(a.data),v()}catch(a){console.error("주식사기 실패..",a)}},v=()=>{g("close")};return(a,l)=>(k(),$("div",R,[t("div",U,[l[8]||(l[8]=t("div",{class:"modal-header mb-4 d-flex justify-content-between align-items-center"},[t("span",{class:"fs-3 fw-bold"},"싹싹주식 매수하기")],-1)),t("div",A,[t("div",z,[l[4]||(l[4]=t("span",{class:"fs-5"},"싹싹 주식 금액 : ",-1)),t("span",H,p(n.value.stockPrice)+" 씨드",1)]),t("div",G,[l[5]||(l[5]=t("span",{class:"fs-5"},"구매 가능한 주식 수량 : ",-1)),t("span",J,p(u.value)+" 싹싹",1)]),t("div",K,[l[6]||(l[6]=t("span",{class:"d-block fs-5 mb-2"},"구매할 수량",-1)),t("div",W,[Q(t("input",{type:"number",class:"form-control w-50","onUpdate:modelValue":l[0]||(l[0]=C=>e.value=C),placeholder:"0"},null,512),[[M,e.value]])]),t("div",X,[t("button",{class:"btn btn-outline btn-outline-danger me-2 pt-0 pb-1",onClick:l[1]||(l[1]=C=>_(5))},"+5"),t("button",{class:"btn btn-outline-danger btn-color-danger me-2 pt-0 pb-1",onClick:l[2]||(l[2]=C=>_(10))},"+10"),t("button",{class:"btn btn-outline-danger btn-color-danger me-2 pt-0 pb-1",onClick:l[3]||(l[3]=C=>_(20))},"+20"),t("button",{class:"btn btn-outline-danger btn-color-danger pt-0 pb-1",onClick:h},"전체")])]),t("div",Y,[l[7]||(l[7]=t("span",{class:"d-block fs-5"},"주문 금액:",-1)),t("span",Z,p(o.value)+" 씨드",1)])]),t("div",{class:"modal-footer d-flex justify-content-end"},[t("button",{class:"btn btn-secondary me-2",onClick:v},"닫기"),t("button",{class:"btn btn-danger",onClick:y},"매수하기")])])]))}},st=w(tt,[["__scopeId","data-v-fb9aa980"]]),et={class:"modal-wrap"},ot={class:"modal-container p-4 shadow-lg rounded bg-white"},at={class:"modal-body"},nt={class:"mb-2"},lt={class:"fs-5 fw-bold"},ct={class:"mb-3"},rt={class:"fs-5 fw-bold txt-primary"},it={class:"mb-3"},ut={class:"d-flex align-items-center"},dt={class:"mt-2"},mt={class:"mb-3"},vt={class:"fs-5 fw-bold"},pt={__name:"StockSell",emits:["closePop"],setup(x,{emit:b}){const i=N(),e=f(""),m=S(),d=r(()=>m.myStock),c=r(()=>m.chartData);r(()=>{const v=c.value[c.value.length-1];return!v||!v.stockPrice?0:parseInt(d.value.seed/v.stockPrice)});const u=r(()=>c.value.length===0?0:c.value[c.value.length-1]),n=r(()=>e.value*u.value.stockPrice),o=f({username:i.username,name:i.name,quantity:"",stock_price:""}),s=v=>{e.value=Number(e.value)+Number(v)},_=()=>{e.value=d.value.totalQuantity},h=b,g=async()=>{o.value.quantity=e.value,o.value.stock_price=u.value.stockPrice;try{const v=await T.sellStock(o.value);m.updateMyStock(v.data),y()}catch(v){console.error("주식팔기 실패..",v)}},y=()=>{h("close")};return(v,a)=>(k(),$("div",et,[t("div",ot,[a[8]||(a[8]=t("div",{class:"modal-header mb-4 d-flex justify-content-between align-items-center"},[t("span",{class:"fs-3 fw-bold"},"싹싹주식 판매하기")],-1)),t("div",at,[t("div",nt,[a[4]||(a[4]=t("span",{class:"fs-5"},"싹싹 주식 금액 : ",-1)),t("span",lt,p(u.value.stockPrice)+" 씨드",1)]),t("div",ct,[a[5]||(a[5]=t("span",{class:"fs-5"},"판매 가능한 주식 수량 : ",-1)),t("span",rt,p(d.value.totalQuantity)+" 싹싹",1)]),t("div",it,[a[6]||(a[6]=t("span",{class:"d-block fs-5 mb-2"},"판매할 수량",-1)),t("div",ut,[Q(t("input",{type:"number",class:"form-control w-50","onUpdate:modelValue":a[0]||(a[0]=l=>e.value=l),placeholder:"0"},null,512),[[M,e.value]])]),t("div",dt,[t("button",{class:"btn btn-outline btn-quantity btn-outline-primary me-2",onClick:a[1]||(a[1]=l=>s(5))},"+5"),t("button",{class:"btn btn-outline-primary btn-quantity btn-color-primary me-2",onClick:a[2]||(a[2]=l=>s(10))},"+10"),t("button",{class:"btn btn-outline-primary btn-quantity btn-color-primary me-2",onClick:a[3]||(a[3]=l=>s(20))},"+20"),t("button",{class:"btn btn-outline-primary btn-quantity btn-color-primary",onClick:_},"최대")])]),t("div",mt,[a[7]||(a[7]=t("span",{class:"fs-5 me-2"},"주문 금액 :",-1)),t("span",vt,p(n.value)+" 씨드",1)])]),t("div",{class:"modal-footer d-flex justify-content-end"},[t("button",{class:"btn btn-secondary me-2",onClick:y},"닫기"),t("button",{class:"btn btn-primary",onClick:g},"매도하기")])])]))}},bt=w(pt,[["__scopeId","data-v-0ae70bca"]]),kt={class:"container p-0 mt-2"},ft={class:"mt-2"},_t={class:"fs-4 fw-semibold"},ht={class:"fs-4 fw-semibold"},yt={__name:"StockTrade",setup(x){const b=S(),i=r(()=>b.myStock),e=r(()=>b.chartData),m=r(()=>{const o=e.value[e.value.length-1];return!o||!o.stockPrice?0:parseInt(i.value.seed/o.stockPrice)}),d=f(!1),c=f(!1),u=()=>{d.value=!d.value},n=()=>{c.value=!c.value};return(o,s)=>(k(),$(E,null,[t("div",kt,[t("div",ft,[s[0]||(s[0]=t("span",{class:"fs-4"},"현재 주문 가능 주식 : ",-1)),t("span",_t,p(m.value)+" 싹싹",1)]),t("div",null,[s[1]||(s[1]=t("span",{class:"fs-4"},"현재 판매 가능 주식 : ",-1)),t("span",ht,p(i.value.totalQuantity)+" 싹싹",1)]),t("div",{class:"mt-4 d-flex"},[t("button",{class:"btn btn-danger me-1 w-50",onClick:u},"주식 구매하기"),t("button",{class:"btn btn-primary w-50",onClick:n},"주식 판매하기")])]),d.value?(k(),P(st,{key:0,onClose:u})):I("",!0),c.value?(k(),P(bt,{key:1,onClose:n})):I("",!0)],64))}},gt=w(yt,[["__scopeId","data-v-9050aae0"]]),St={class:"container"},wt={class:"shadow card p-4 bg-card"},$t={class:"row"},xt={class:"col-5"},Ct={class:"chart-title"},Dt={class:"fs-5 mb-0 text-danger fw-semibold"},Pt={class:"fs-5 txt-primary fw-semibold"},It={class:"fs-5 mt-3 mb-1"},Nt={class:"fw-bold text-danger"},qt={class:"fs-5 mb-1 mb-3"},Bt={class:"fw-bold txt-primary"},Qt={class:"col-7"},Mt={__name:"StockChartLayout",setup(x){const b=S(),i=N(),e=r(()=>b.chartData),m=i.roles,d=r(()=>e.value.length===0?0:e.value.reduce((o,s)=>o.stockPrice>=s.stockPrice?o:s)),c=r(()=>e.value.length===0?0:e.value.reduce((o,s)=>o.stockPrice<=s.stockPrice?o:s)),u=r(()=>e.value.length===0?0:e.value[e.value.length-1]),n=r(()=>e.value.length===0?0:e.value[e.value.length-1].stockPrice-e.value[e.value.length-2].stockPrice);return(o,s)=>(k(),$("div",St,[t("div",wt,[t("div",$t,[t("div",xt,[s[4]||(s[4]=t("div",{class:"mx-1 mt-2 mb-3"},null,-1)),s[5]||(s[5]=t("div",{class:"d-flex align-items-center mb-2"},null,-1)),t("div",Ct,[t("p",Dt,[s[0]||(s[0]=t("span",{class:"text-gray"},"오늘의 가격",-1)),D(" "+p(u.value.stockPrice)+" 씨드",1)])]),t("p",Pt,[s[1]||(s[1]=t("span",{class:"fs-6 text-muted pe-2"},"어제보다",-1)),D(" "+p(n.value)+" 씨드 ("+p(u.value.change>=0?`+${u.value.change}`:u.value.change)+"%) ",1)]),s[6]||(s[6]=t("hr",null,null,-1)),t("p",It,[s[2]||(s[2]=D("최고 가격 (30일): ")),t("span",Nt,p(d.value.stockPrice)+" 씨드",1)]),t("p",qt,[s[3]||(s[3]=D("최저 가격 (30일): ")),t("span",Bt,p(c.value.stockPrice)+" 씨드",1)]),s[7]||(s[7]=t("hr",null,null,-1)),t("div",null,[B(m)[0]==="ROLE_STUDENT"?(k(),P(gt,{key:0})):I("",!0)])]),t("div",Qt,[q(O)])])])]))}},Et=w(Mt,[["__scopeId","data-v-9f15c3e2"]]);export{Et as S};
