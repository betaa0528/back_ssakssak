import{_ as g,b as i,c as m,C as v,I as f,o as t,e as n,f as u,F as y,q as k,Q as d,t as b}from"./index-gxZJ1D_R.js";const S={class:"container my-4"},A={class:"list-group"},E=["onClick"],w={__name:"Alarm",setup(x){i();const a=m([]);let o;const c=m({usernmae:""}),p=async()=>{try{const e=await _(),s=await d.get("/api/alarm/history",{params:{username:e.username}});a.value=s.data}catch(e){console.error("Failed : ",e)}},_=async()=>{const e=i();return c.username=e.username,c},h=async(e,s)=>{try{console.log(e);const r=d.post("/api/alarm/checked/"+e);a.value.splice(s,1)}catch(r){console.error("Failed checked alarm",r)}};return v(()=>{p();const e=1;o=new EventSource(`/api/alarm/subscribe/${e}`),o.addEventListener("alarm",s=>{const r=s.data;console.log(r),a.value=[...a.value,{message:r}]}),o.onerror=s=>{console.error("Error with SSE connection",s)}}),f(()=>{o&&o.close()}),(e,s)=>(t(),n("div",S,[s[0]||(s[0]=u("h2",{class:"text-center p-3 bg-light border rounded"},"알람 페이지",-1)),u("ul",A,[(t(!0),n(y,null,k(a.value,(r,l)=>(t(),n("li",{key:l,class:"list-group-item mb-1 alarm-item",onClick:F=>h(r.id,l)},b(r.message),9,E))),128))])]))}},C=g(w,[["__scopeId","data-v-c1a9124b"]]);export{C as default};
