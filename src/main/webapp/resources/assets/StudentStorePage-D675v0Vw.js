import{_ as w,c,a as L,d as O,E as $,o as u,e as d,f as o,t as i,w as R,v as T,g as b,F as C,B,C as S,h as U,P as W,q as z,k as A}from"./index-DvTNLHIP.js";import{a as g}from"./studentStoreApi-BVAzvGQy.js";const G="/assets/coupon-BUEPidbW.png",v=s=>(B("data-v-149a8555"),s=s(),S(),s),H={class:"modal-wrap"},J={class:"modal-container shadow-lg p-2"},K={class:"row card-body align-items-start p-2"},X=v(()=>o("div",{class:"col-4 mt-2"},[o("div",{class:"imgBox"},[o("img",{src:G,alt:"쿠폰 이미지"})])],-1)),Y={class:"col-8"},Z=v(()=>o("span",{class:"d-block mt-2 text-muted fs-6"},"쿠폰",-1)),oo=v(()=>o("i",{class:"bi bi-x-lg"},null,-1)),so=[oo],to={class:"d-block fs-5 fw-bold"},eo={class:"text-end mb-2"},co={class:"fs-5 fw-semibold primary"},no=v(()=>o("div",{class:"mb-4"},null,-1)),ao={class:"mb-3 d-flex justify-content-between"},lo={class:"d-flex"},io=["disabled"],uo={class:"fs-4 fw-semibold text-danger"},ro={key:0,class:"confirm-modal"},po=v(()=>o("p",{class:"fs-5 fw-semibold"},"정말로 구매하시겠습니까?",-1)),_o={key:1,class:"confirm-modal"},mo=v(()=>o("p",{class:"fs-5 fw-semibold"},"구매가 완료되었습니다!",-1)),vo={key:2,class:"confirm-modal"},fo={class:"confirm-container shadow-lg p-4"},ho={class:"fs-5 fw-semibold"},bo={__name:"StoreItemDetails",props:{couponId:{type:Number,required:!0},coupon:{type:Object,required:!0}},emits:["close","couponBuy"],setup(s,{emit:_}){const t=c(1),r=c(0);c(!1);const e=c(!1),m=c(!1),p=c(!1),n=c({}),f=L(),l=s;c("");const M=async()=>{if(!l.couponId){console.error("Invalid coupon ID:",l.couponId);return}try{const a=await g.getCouponById(l.couponId);n.value=a,r.value=n.value.cpPrice}catch(a){console.error("Failed to fetch coupon details:",a)}},P=()=>{e.value=!0},y=()=>{e.value=!1},q=()=>{h("close"),f.go(0),m.value=!1},j=()=>{h("close"),p.value=!1},D=()=>{t.value>1&&t.value--},N=()=>{t.value++},F=O(()=>t.value*r.value),h=_,Q=()=>{h("close")},I=c({cpId:l.couponId,quantity:"",price:l.coupon.cpPrice}),x=c(""),V=async()=>{try{I.value.quantity=t.value;const a=await g.buyCoupon(I);console.log(a),a&&a.status===200&&(l.coupon.cpQuantity-=t.value,h("couponBuy",{couponId:l.couponId,coupon:l.coupon}),y(),m.value=!0)}catch(a){x.value=a.response.data,console.error("쿠폰 사기 실패",a),y(),p.value=!0}};return $(()=>{M()}),(a,k)=>(u(),d(C,null,[o("div",H,[o("div",J,[o("div",K,[X,o("div",Y,[o("div",{class:"d-flex justify-content-between"},[Z,o("button",{class:"btn btn-outline-secondary text-center",onClick:Q},so)]),o("div",null,[o("span",to,i(n.value.cpName),1)]),o("div",eo,[o("span",co,i(n.value.cpQuantity)+"개 / "+i(n.value.cpPrice)+" 씨드",1)]),o("div",null,i(n.value.cpContent),1),no,o("div",ao,[o("div",lo,[o("button",{class:"button cyan small fs-5",onClick:D},"-"),R(o("input",{type:"text",class:"form-control text-center fs-6 fw-semibold","onUpdate:modelValue":k[0]||(k[0]=E=>t.value=E)},null,512),[[T,t.value]]),o("button",{class:"button cyan small fs-5",disabled:t.value>=n.value.cpQuantity,onClick:N},"+",8,io)]),o("div",uo,[o("span",null,i(F.value)+" 씨드",1)])]),o("div",{class:"text-end"},[o("button",{class:"btn btn-primary",onClick:P},"구매하기")])])])])]),e.value?(u(),d("div",ro,[o("div",{class:"confirm-container shadow-lg p-4"},[po,o("div",{class:"d-flex justify-content-center mt-3",style:{gap:"10px"}},[o("button",{class:"btn btn-primary",onClick:V},"구매"),o("button",{class:"btn btn-secondary",onClick:y},"취소")])])])):b("",!0),m.value?(u(),d("div",_o,[o("div",{class:"confirm-container shadow-lg p-4"},[mo,o("div",{class:"d-flex justify-content-center mt-3"},[o("button",{class:"btn btn-primary",onClick:q},"확인")])])])):b("",!0),p.value?(u(),d("div",vo,[o("div",fo,[o("p",ho,i(x.value),1),o("div",{class:"d-flex justify-content-center mt-3"},[o("button",{class:"btn btn-primary",onClick:j},"확인")])])])):b("",!0)],64))}},yo=w(bo,[["__scopeId","data-v-149a8555"]]),go=s=>(B("data-v-189d1f43"),s=s(),S(),s),wo={class:"container"},Co={class:"card shadow-lg p-2"},Io={class:"card-body align-items-center"},xo={class:"row"},ko={class:"imgBox"},$o=["src"],Bo={class:"row"},So=go(()=>o("span",{class:"d-block mt-2 text-muted fs-6"},"쿠폰",-1)),Mo={class:"mb-2"},Po={class:"fs-5 fw-bold d-block coupon-name"},qo={class:"mb-4"},jo={class:"fs-5 fw-semibold primary"},Do={class:"mb-4"},No={class:"fs-6 text-muted"},Fo={class:"fw-bold"},Qo={__name:"StoreItem",props:{coupon:{type:Object,required:!0}},emits:["couponBuy"],setup(s,{emit:_}){const t=c(!1),r=()=>{t.value=!t.value},e=s,m=_,p=()=>{m("couponBuy",e.coupon)},n=f=>"/src/assets/images/coupon.png";return(f,l)=>(u(),d(C,null,[o("div",wo,[o("div",Co,[o("div",Io,[o("div",xo,[o("div",ko,[o("img",{src:n(s.coupon.cpImage),alt:"쿠폰 이미지"},null,8,$o)])]),o("div",Bo,[So,o("div",Mo,[o("span",Po,i(s.coupon.cpName),1)]),o("div",qo,[o("span",jo,i(s.coupon.cpPrice)+" 씨드",1)]),o("div",Do,[o("span",No,[U("남은 수량: "),o("span",Fo,i(s.coupon.cpQuantity),1)])]),o("div",null,[o("button",{class:"btn btn-primary btn-lg w-100",onClick:r},"상세보기")])])])])]),t.value?(u(),W(yo,{key:0,couponId:s.coupon.cpId,coupon:s.coupon,onClose:r,onCouponBuy:p},null,8,["couponId","coupon"])):b("",!0)],64))}},Vo=w(Qo,[["__scopeId","data-v-189d1f43"]]),Eo={class:"container mt-5"},Lo={class:"row g-0"},Oo={__name:"StudentStorePage",setup(s){const _=c([]),t=async()=>{try{const e=await g.getCouponlist();_.value=e}catch(e){console.error("Failed to fetch coupon list:",e)}};$(()=>{t()});const r=e=>{console.log("Coupon purchased:",e)};return(e,m)=>(u(),d("div",Eo,[o("div",Lo,[(u(!0),d(C,null,z(_.value,(p,n)=>(u(),d("div",{class:"col-12 col-md-6 col-lg-4 mb-4",key:n},[A(Vo,{coupon:p,onCouponBuy:r},null,8,["coupon"])]))),128))])]))}},Uo=w(Oo,[["__scopeId","data-v-8d302d75"]]);export{Uo as default};
