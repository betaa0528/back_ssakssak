import{m as p,P as K,_ as W,c as m,u as z,a as O,C as Q,r as X,d as V,p as Y,j as Z,o as l,e as n,f as t,x as G,F as k,q as L,h as R,i as tt,w as F,v as T,t as r,k as et,l as C,J as st}from"./index-gxZJ1D_R.js";const f="/api/teacher/reward",v={async getRewardList(){try{const{data:s}=await p.get(`${f}/list`);return console.log(s),s}catch(s){console.error("Failed fetch reward list",s)}},async addReward(s){try{const{data:o}=await p.post(`${f}/apply`,s);return o}catch(o){throw console.error("Failed reward add"),o}},async deleteReward(s){try{const{data:o}=await p.post(`${f}/${s}`);return o}catch(o){throw o}},async getStudentList(){try{const{data:s}=await p.get(`${f}/student-list`);return s}catch(s){throw s}},async sendRewardToStudent(s){try{return await p.post(`${f}/pay`,s)}catch(o){console.log(o)}},async getRewardGiveList(s){try{const{data:o}=await p.get(`${f}/pay/list`,{params:s});return o}catch(o){console.error(o)}}},at=K("reward",{state:()=>({rewardList:[],rewardGiveList:[],studentList:[]}),actions:{async fetchRewardList(){try{const s=await v.getRewardList();this.rewardList=s}catch(s){throw console.error("Failed to fetch reward:",s),s}},async fetchStudentList(){try{const s=await v.getStudentList();this.studentList=s}catch(s){throw console.error("Failed to fetch studentList:",s),s}},async fetchRewardGiveList(){try{const s=await v.getRewardGiveList();this.rewardGiveList=s}catch(s){throw console.error("Failed to fetch rewardGiveList",s),s}}},persist:!0}),dt={class:"container mt-5"},ot={key:0},lt={class:"row"},nt={class:"col-12 col-md-6 reward-list"},rt={class:"card shadow-sm mb-3",style:{height:"30%"}},it={class:"card-body pt-0 mt-3"},ct={key:0,class:"reward-list-wrap",style:{"overflow-y":"auto","max-height":"80vh"}},vt=["onClick"],ut={class:"fs-5 text-dark"},wt={class:"col-4 text-center"},pt={class:"fs-5 text-dark"},mt={class:"col-2 text-center pe-2"},ft=["onClick"],ht={class:"mt-2"},xt={class:"mb-3 d-flex justify-content-between align-items-center"},yt={class:"d-flex align-items-center reward-add-box"},_t={class:"card shadow-sm",style:{height:"30%"}},gt={class:"p-0 mt-3 text-center d-flex flex-column",style:{height:"100%"}},bt={class:"std-list-wrap",style:{"overflow-y":"scroll"}},kt=["onClick"],Lt={class:"col-2 text-center pt-1"},Rt=["value","onChange","checked"],Ct={class:"col-2 text-center",style:{"overflow-x":"auto"}},St={class:"fs-5 text-dark"},$t={class:"col-4 text-center"},It={class:"fs-5 text-dark"},Vt={class:"col-4 text-center"},Gt={class:"fs-5 text-dark"},Nt={class:"col-12 col-md-6"},qt={class:"card shadow-sm reward-card d-flex flex-column",style:{height:"100%"}},Ft={class:"m-4",style:{flex:"0.7",display:"flex","flex-direction":"column","justify-content":"flex-start","padding-top":"200px"}},Tt={class:"d-flex mt-2 ms-3 flex-wrap"},jt=["onClick"],Dt={class:"mx-4",style:{flex:"1",display:"flex","flex-direction":"column","justify-content":"flex-start"}},At={class:"d-flex mt-2 ms-3 flex-wrap"},Bt={key:1},Pt={class:"card mt-3 reward-card2"},Ut={class:"p-0 mt-3 d-flex flex-column",style:{height:"100%"}},Mt={class:"col-3 text-center"},Et={class:"fs-5 text-dark"},Ht={class:"col-2 text-center",style:{"overflow-x":"auto"}},Jt={class:"fs-5 text-dark"},Kt={class:"col-5 text-center"},Wt={class:"fs-5 text-dark"},zt={class:"col-2 text-center"},Ot={class:"fs-5 text-dark"},Qt={class:"my-5 d-flex"},Xt={class:"flex-grow-1 text-center"},Yt={__name:"TeacherRewardPage",setup(s){const o=m("reward"),h=z(),j=O(),c=at();Q(()=>{c.fetchRewardList(),c.fetchStudentList(),c.fetchRewardGiveList()});const x=m({}),y=X({page:parseInt(h.query.page)||1,amount:parseInt(h.query.amount)||12});console.log(x.value);const S=V(()=>c.rewardList),D=V(()=>x.value.rewardList),N=V(()=>c.studentList),g=m(""),b=m(""),A=async()=>{try{const d={reward_name:g.value,reward_seed:b.value},e=await v.addReward(d);console.log(e),g.value="",b.value="",await c.fetchRewardList()}catch(d){console.log(d)}},B=async d=>{await v.deleteReward(d),c.fetchRewardList()},i=m([]),u=m(null),P=d=>{u.value=S.value.find(e=>e.rewardId===d)},U=()=>{u.value=""},$=d=>{console.log(d);const e=i.value.findIndex(w=>w.std_id===d.std_id);e>-1?i.value.splice(e,1):i.value.push(d)},M=()=>{i.value=[...N.value]},E=()=>{i.value=[]},H=async()=>{try{const e={students:i.value.map(a=>st(a)),reward_id:u.value.rewardId},w=await v.sendRewardToStudent(e);w.status===200&&alert(w.data),i.value=[],u.value=null,await c.fetchStudentList(),I()}catch{alert("잘못된 요청입니다.")}},J=async d=>{console.log("CLICK,,,,"),j.push({query:{page:d,amount:y.amount}})};Y(h,async d=>{console.log("WATCH",h.query.page),await I(h.query)});const I=async d=>{try{x.value=await v.getRewardGiveList(d),console.log("asdf",x.value)}catch{}};return I(y),(d,e)=>{const w=Z("vue-awesome-paginate");return l(),n("div",dt,[o.value==="reward"?(l(),n("div",ot,[t("div",lt,[t("div",nt,[t("div",rt,[e[9]||(e[9]=t("div",{class:"reward-title mt-4 ms-4"},[t("span",{class:"fs-2 fw-bold ms-3"},"현재 리워드 목록")],-1)),t("div",it,[e[8]||(e[8]=G('<div class="d-flex row m-0 mb-2 pe-3" style="width:100%;" data-v-56d4d63d><div class="col-6 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>리워드 명</span></div><div class="col-4 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>금액</span></div><div class="col-2 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>삭제</span></div></div><hr data-v-56d4d63d>',2)),S.value?(l(),n("div",ct,[(l(!0),n(k,null,L(S.value,(a,_)=>(l(),n("div",{key:a.rewardId,class:"d-flex text-center py-2 list-item",style:{width:"100%"}},[t("div",{class:"col-6 text-center reward-name",onClick:q=>P(a.rewardId)},[t("span",ut,r(a.rewardName),1)],8,vt),t("div",wt,[t("span",pt,r(a.rewardSeed)+" 씨드",1)]),t("div",mt,[t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:q=>B(a.rewardId)},e[3]||(e[3]=[t("i",{class:"bi bi-trash"},null,-1)]),8,ft)])]))),128))])):R("",!0),t("div",ht,[t("form",{onSubmit:tt(A,["prevent"])},[t("div",xt,[e[4]||(e[4]=t("label",{class:"form-label fs-5 fw-bold reward-label"},"리워드 명",-1)),F(t("input",{type:"text",class:"form-control reward-input","onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),placeholder:"ex) 밥을 남기지 않고 잘 먹어요"},null,512),[[T,g.value]])]),t("div",yt,[e[5]||(e[5]=t("label",{class:"form-label fs-5 fw-bold reward-amount"},"금액",-1)),F(t("input",{type:"text",class:"form-control me-2 w-50 text-end","onUpdate:modelValue":e[1]||(e[1]=a=>b.value=a),placeholder:"ex) 300"},null,512),[[T,b.value]]),e[6]||(e[6]=t("span",{class:"me-4"}," 씨드 ",-1)),e[7]||(e[7]=t("button",{class:"btn btn-primary px-3",type:"submit"},"리워드 추가",-1))])],32)])])]),t("div",_t,[t("div",{class:"d-flex justify-content-between mt-4 ms-4"},[e[10]||(e[10]=t("span",{class:"fs-2 fw-bold ms-1"},"학생 목록",-1)),t("div",{class:"p-0 me-4"},[t("button",{class:"btn btn-primary me-2 py-2",onClick:M},"전체선택"),t("button",{class:"btn btn-outline-primary me-2 px-3 py-2",onClick:E},"전체선택해제")])]),t("div",gt,[e[11]||(e[11]=G('<div class="d-flex row m-0 mb-2 pe-2" style="width:100%;" data-v-56d4d63d><div class="col-2 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>선택</span></div><div class="col-2 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>번호</span></div><div class="col-4 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>이름</span></div><div class="col-4 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>보유 씨드</span></div></div>',1)),t("div",bt,[(l(!0),n(k,null,L(N.value,a=>(l(),n("div",{key:a.std_id,class:"d-flex text-center py-2 name-box",style:{width:"100%"},onClick:_=>$(a)},[t("div",Lt,[t("input",{type:"checkbox",value:a,onChange:_=>$(a),checked:i.value.includes(a)},null,40,Rt)]),t("div",Ct,[t("span",St,r(a.std_id),1)]),t("div",$t,[t("span",It,r(a.std_name),1)]),t("div",Vt,[t("span",Gt,r(a.seed),1)])],8,kt))),128))])])])]),t("div",Nt,[t("div",qt,[t("div",Ft,[e[12]||(e[12]=t("div",{class:"ms-2 mt-6"},[t("span",{class:"reward-title fs-3 fw-bold"},"리워드 적용 학생")],-1)),t("div",Tt,[(l(!0),n(k,null,L(i.value,(a,_)=>(l(),n("div",{key:_,class:"btn btn-warning cyan me-2 mb-3",onClick:q=>$(a)},r(a.std_name),9,jt))),128))])]),t("div",Dt,[e[13]||(e[13]=t("div",{class:"ms-2"},[t("span",{class:"fs-3 fw-bold"},"적용 리워드")],-1)),t("div",At,[u.value?(l(),n("div",{key:0,class:"btn btn-warning d-inline-block",onClick:U},r(u.value.rewardName),1)):R("",!0)])]),t("div",{class:"text-center p-3 mt-auto mb-4"},[t("button",{class:"btn btn-warning",style:{width:"80%"},onClick:H},"리워드 지급")])])])])])):R("",!0),o.value==="reward"?(l(),n("div",Bt,[t("div",Pt,[e[19]||(e[19]=t("div",{class:"mt-4 ms-4"},[t("span",{class:"fs-2 fw-bold ms-3"},"리워드 지급 목록")],-1)),t("div",null,[t("div",Ut,[e[18]||(e[18]=G('<div class="d-flex row m-0 mb-2 mx-auto" style="width:90%;" data-v-56d4d63d><div class="col-3 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>날짜</span></div><div class="col-2 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>이름</span></div><div class="col-5 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>리워드명</span></div><div class="col-2 text-center" data-v-56d4d63d><span class="h4" data-v-56d4d63d>금액</span></div></div>',1)),t("div",null,[(l(!0),n(k,null,L(D.value,(a,_)=>(l(),n("div",{key:a.giveId,class:"d-flex py-2 mx-auto",style:{width:"90%"}},[t("div",Mt,[t("span",Et,r(a.giveDate),1)]),t("div",Ht,[t("span",Jt,r(a.stdName),1)]),t("div",Kt,[t("span",Wt,r(a.rewardName),1)]),t("div",zt,[t("span",Ot,r(a.giveSeed)+" 씨드",1)])]))),128)),t("div",Qt,[t("div",Xt,[et(w,{"total-items":x.value.totalCount,"items-per-page":y.amount,"max-pages-shown":5,"show-ending-buttons":!0,modelValue:y.page,"onUpdate:modelValue":e[2]||(e[2]=a=>y.page=a),onClick:J},{"first-page-button":C(()=>e[14]||(e[14]=[t("i",{class:"fa-solid fa-backward-fast"},null,-1)])),"prev-button":C(()=>e[15]||(e[15]=[t("i",{class:"fa-solid fa-caret-left"},null,-1)])),"next-button":C(()=>e[16]||(e[16]=[t("i",{class:"fa-solid fa-caret-right"},null,-1)])),"last-page-button":C(()=>e[17]||(e[17]=[t("i",{class:"fa-solid fa-forward-fast"},null,-1)])),_:1},8,["total-items","items-per-page","modelValue"])])])])])])])])):R("",!0)])}}},te=W(Yt,[["__scopeId","data-v-56d4d63d"]]);export{te as default};
